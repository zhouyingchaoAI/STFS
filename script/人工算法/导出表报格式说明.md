# 增长率分析表报格式说明

## 📥 导出功能

计算完增长率后，点击"📥 导出分析表报"按钮，系统会生成CSV文件供下载。

## 📋 表报字段

导出的CSV文件包含以下字段：

| 字段名 | 说明 | 示例值 |
|--------|------|--------|
| 年份 | 数据所属年份 | 2025 |
| 日期 | 具体日期（yyyymmdd格式） | 20250501 |
| 线路编号 | 线路的编号 | 1 |
| 线路名称 | 线路的名称 | 1号线 |
| 基期范围 | 该年使用的基期日期范围 | 2025-04-01 至 2025-04-30 |
| 基期日均 | 基期的日均客流量 | 125678 |
| 当日客流量 | 对比期当天的客流量 | 145890 |
| 增长量 | 当日客流 - 基期日均 | 20212 |
| 增长率(%) | (增长量 / 基期日均) × 100 | 16.07 |

## 📊 数据排序

数据按以下顺序排列：
1. **年份**：降序（最新年份在最前）
2. **线路编号**：升序（1号线、2号线...）
3. **日期**：升序（5月1日、5月2日...）

## 💾 文件命名

文件名格式：
```
增长率分析_[指标类型]_[开始日期]至[结束日期].csv
```

示例：
- `增长率分析_客流量_2025-05-01至2025-05-05.csv`
- `增长率分析_进站人数_2025-10-01至2025-10-07.csv`

## 📈 表报示例

### 单年模式（仅对比基期）

```csv
年份,日期,线路编号,线路名称,基期范围,基期日均,当日客流量,增长量,增长率(%)
2025,20250501,1,1号线,2025-04-01 至 2025-04-30,125678,145890,20212,16.07
2025,20250502,1,1号线,2025-04-01 至 2025-04-30,125678,148320,22642,18.02
2025,20250503,1,1号线,2025-04-01 至 2025-04-30,125678,142156,16478,13.11
2025,20250501,2,2号线,2025-04-01 至 2025-04-30,98234,112456,14222,14.48
...
```

### 多年模式（对比前3年）

```csv
年份,日期,线路编号,线路名称,基期范围,基期日均,当日客流量,增长量,增长率(%)
2025,20250501,1,1号线,2025-04-01 至 2025-04-30,125678,145890,20212,16.07
2025,20250502,1,1号线,2025-04-01 至 2025-04-30,125678,148320,22642,18.02
...
2024,20240501,1,1号线,2025-04-01 至 2025-04-30,125678,140234,14556,11.58
2024,20240502,1,1号线,2025-04-01 至 2025-04-30,125678,142890,17212,13.69
...
2023,20230501,1,1号线,2025-04-01 至 2025-04-30,125678,135467,9789,7.79
...
2022,20220501,1,1号线,2025-04-01 至 2025-04-30,125678,130245,4567,3.63
...
```

## 🔧 使用场景

### 1. Excel分析
- 用Excel打开CSV文件
- 创建数据透视表
- 绘制自定义图表
- 进行深度数据分析

### 2. 报告制作
- 导出数据后复制到Word/PPT
- 制作专业的分析报告
- 展示给领导或客户

### 3. 数据归档
- 保存历史分析结果
- 建立数据档案
- 方便后续对比

### 4. 二次处理
- 导入到Python/R进行统计分析
- 使用BI工具（如Tableau）可视化
- 与其他数据源合并分析

## 📝 注意事项

### 编码格式
CSV文件使用 **UTF-8 BOM** 编码，确保：
- ✅ Excel可以正确显示中文
- ✅ 兼容Windows和Mac系统
- ✅ 不会出现乱码问题

### 数字格式
- 客流量、增长量：整数（四舍五入）
- 增长率：保留2位小数
- 线路编号：整数

### 数据完整性
导出的数据包含：
- ✅ 所有选定的年份
- ✅ 所有线路
- ✅ 对比期的每一天
- ✅ 完整的计算结果

## 💡 使用技巧

### 技巧1：筛选特定线路
在Excel中使用筛选功能，只查看某条线路的数据：
1. 点击"线路名称"列的筛选按钮
2. 选择要查看的线路
3. 查看该线路多年的增长趋势

### 技巧2：创建数据透视表
在Excel中创建数据透视表：
- 行：线路名称
- 列：年份
- 值：平均增长率
- 快速对比各线路各年表现

### 技巧3：绘制趋势图
使用Excel图表功能：
1. 选择某条线路的数据
2. 插入折线图
3. X轴：日期，Y轴：增长率
4. 多条系列：不同年份

## 🌐 导出路径

默认下载到浏览器的下载文件夹。

## ❓ 常见问题

### Q: CSV文件打开后中文乱码怎么办？
A: 文件已使用UTF-8 BOM编码，Excel应该自动识别。如果仍有问题：
1. 用记事本打开CSV
2. 另存为 → 选择ANSI编码
3. 用Excel打开新文件

### Q: 导出的数据和界面显示的一致吗？
A: 完全一致。导出包含界面上显示的所有数据。

### Q: 可以导出多次吗？
A: 可以。每次计算后都可以导出，不限次数。

### Q: 导出时会重新查询数据库吗？
A: 是的。导出时会重新查询以确保数据最新和完整。

