 * Serving Flask app 'web_app'
 * Debug mode: off
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:4566
 * Running on http://172.17.0.12:4566
[33mPress CTRL+C to quit[0m
10.1.33.138 - - [24/Oct/2025 01:12:04] "GET / HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:12:05] "POST /check_data_availability HTTP/1.1" 200 -
10.1.33.138 - - [24/Oct/2025 01:12:05] "POST /check_station_data_availability HTTP/1.1" 200 -
10.1.33.138 - - [24/Oct/2025 01:12:06] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:12:15] "POST /calculate_growth HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:13:01] "POST /check_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:13:10] "POST /check_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:13:14] "POST /check_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:13:15] "POST /check_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:13:21] "POST /predict_flow HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:19:52] "POST /predict_flow HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
åº”ç”¨è½¦ç«™è¿‡æ»¤ï¼š['æ©˜å­æ´²', 'äº”ä¸€å¹¿åœº', 'ç¢§æ²™æ¹–']
å®Œæ•´SQL:

        SELECT 
            S.ID,
            REPLACE(S.SQUAD_DATE, '-', '') AS F_DATE,
            S.STATION_ID AS F_LINENO,
            S.STATION_NAME AS F_LINENAME,
            S.PASSENGER_NUM AS F_KLCOUNT,
            C.F_DATEFEATURES,
            C.F_ISHOLIDAY,
            C.F_ISNONGLI,
            C.F_ISYANGLI,
            C.F_NEXTDAY,
            C.F_HOLIDAYTHDAY,
            C.IS_FIRST,
            CC.F_YEAR,
            CC.F_DAYOFWEEK,
            CC.F_WEEK,
            CC.F_HOLIDAYTYPE,
            CC.F_HOLIDAYDAYS,
            CC.F_HOLIDAYWHICHDAY,
            CC.COVID19,
            CC.F_WEATHER,
            W.F_TQQK AS WEATHER_TYPE
        FROM 
            [StationFlowPredict].[dbo].[STATION_FLOW_HISTORY] AS S
        LEFT JOIN 
            master.dbo.LSTM_COMMON_HOLIDAYFEATURE AS C
            ON REPLACE(S.SQUAD_DATE, '-', '') = C.F_DATE
        LEFT JOIN 
            master.dbo.CalendarHistory AS CC
            ON REPLACE(S.SQUAD_DATE, '-', '') = CC.F_DATE
        LEFT JOIN
            master.dbo.WeatherHistory AS W
            ON REPLACE(S.SQUAD_DATE, '-', '') = W.F_DATE
        WHERE 
            REPLACE(S.SQUAD_DATE, '-', '') >= '20250930'
            AND REPLACE(S.SQUAD_DATE, '-', '') <= '20251004'
            AND S.STATION_NAME IN (N'æ©˜å­æ´²', N'äº”ä¸€å¹¿åœº', N'ç¢§æ²™æ¹–')
        ORDER BY 
            REPLACE(S.SQUAD_DATE, '-', ''), S.STATION_ID
        
è½¦ç«™æ•°æ®æŸ¥è¯¢å®Œæˆï¼š0è¡Œ
âš ï¸ è½¦ç«™æŸ¥è¯¢ç»“æœä¸ºç©º

============================================================
å¼€å§‹é¢„æµ‹çº¿è·¯å®¢æµ
æŒ‡æ ‡ç±»å‹: F_PKLCOUNT (å®¢æµé‡)
é¢„æµ‹æ—¥æœŸ: 20250430 - 20250505
å‚è€ƒå†å²: å‰2å¹´
è‡ªå®šä¹‰é…ç½®: å¦
============================================================

åŸºæœŸæ•°æ®æŸ¥è¯¢æˆåŠŸï¼š310è¡Œ
åŸºæœŸæ—¥å‡è®¡ç®—å®Œæˆï¼Œå…±10æ¡çº¿è·¯æ•°æ®
base_avg ç±»å‹: <class 'pandas.core.frame.DataFrame'>, å½¢çŠ¶: (10, 3), åˆ—: ['F_LINENO', 'F_LINENAME', 'åŸºæœŸæ—¥å‡']
base_avg å‰å‡ è¡Œ:
   F_LINENO F_LINENAME          åŸºæœŸæ—¥å‡
0         0         çº¿ç½‘  2.228510e+06
1         1        1å·çº¿  3.966289e+05
2         2        2å·çº¿  5.098189e+05
3         3        3å·çº¿  3.250200e+05
4         4        4å·çº¿  3.579985e+05

===== å¤„ç†ç¬¬1å¹´å†å²æ•°æ®ï¼š2024å¹´ =====
âœ“ 2024å¹´ï¼šå‚è€ƒæœŸ60è¡Œ

===== å¤„ç†ç¬¬2å¹´å†å²æ•°æ®ï¼š2023å¹´ =====
âœ“ 2023å¹´ï¼šå‚è€ƒæœŸ54è¡Œ
âœ“ åˆå¹¶å®Œæˆï¼šå…±114è¡Œ

===== å¼€å§‹è®¡ç®—é¢„æµ‹ =====
æ ‡è®°å®Œæˆï¼Œå¼€å§‹è®¡ç®—æ¯å¤©çš„æœ€ä¼˜å¢é•¿ç‡...

âœ“ é¢„æµ‹è®¡ç®—å®Œæˆï¼šå…±60æ¡é¢„æµ‹è®°å½•

===== æŸ¥è¯¢å®é™…æ•°æ® =====
æ—¥æœŸèŒƒå›´ï¼š20250430 - 20250505
æŸ¥è¯¢ç»“æœï¼š60è¡Œ
å®é™…æ•°æ®çš„çº¿è·¯ï¼š[ 0  1  2  3  4  5  6 31 60 83]
å®é™…æ•°æ®çš„æ—¥æœŸï¼š['20250430', '20250501', '20250502', '20250503', '20250504', '20250505']

é¢„æµ‹æ•°æ®ç¤ºä¾‹ï¼ˆå‰3æ¡ï¼‰ï¼š
  é¢„æµ‹ 1: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250430 (<class 'str'>)
  é¢„æµ‹ 2: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250501 (<class 'str'>)
  é¢„æµ‹ 3: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250502 (<class 'str'>)

å®é™…æ•°æ®ç¤ºä¾‹ï¼ˆå‰3æ¡ï¼‰ï¼š
  å®é™… 1: çº¿è·¯=0 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)
  å®é™… 2: çº¿è·¯=1 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)
  å®é™… 3: çº¿è·¯=2 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)

å¼€å§‹åŒ¹é…é¢„æµ‹å€¼å’Œå®é™…å€¼...
  åŒ¹é… 1: çº¿è·¯0 æ—¥æœŸ20250430 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250430: é¢„æµ‹=3380872, å®é™…=2947596, å‡†ç¡®ç‡=85.3%
  åŒ¹é… 2: çº¿è·¯0 æ—¥æœŸ20250501 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250501: é¢„æµ‹=3212174, å®é™…=3128839, å‡†ç¡®ç‡=97.34%
  åŒ¹é… 3: çº¿è·¯0 æ—¥æœŸ20250502 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250502: é¢„æµ‹=2894166, å®é™…=3155998, å‡†ç¡®ç‡=91.7%

âœ“ åŒ¹é…å®Œæˆï¼š60/60 æ¡è®°å½•æœ‰å®é™…æ•°æ®
âœ“ æœ‰å‡†ç¡®ç‡çš„è®°å½•ï¼š60/60

============================================================
å‡†å¤‡è¿”å›ç»“æœï¼šhas_actual = True
predictions æ€»æ•° = 60
ç¬¬ä¸€æ¡è®°å½•ç¤ºä¾‹ï¼š{'çº¿è·¯ç¼–å·': 0, 'çº¿è·¯åç§°': 'çº¿ç½‘', 'é¢„æµ‹æ—¥æœŸ': '20250430', 'ç¬¬å‡ å¤©': 1, 'åŸºæœŸæ—¥å‡': 2228510, 'æœ€ä¼˜å¢é•¿ç‡': 51.71, 'æœ€ä¼˜æ¥æºå¹´ä»½': 2023, 'é¢„æµ‹å®¢æµ': 3380872, 'å®é™…å®¢æµ': 2947596, 'å‡†ç¡®ç‡': 85.3, 'è¯¯å·®': 433276}
============================================================


============================================================
é¢„æµ‹å®Œæˆï¼è¿”å›60æ¡è®°å½•
============================================================


============================================================
å¼€å§‹é¢„æµ‹çº¿è·¯å®¢æµ
æŒ‡æ ‡ç±»å‹: F_PKLCOUNT (å®¢æµé‡)
é¢„æµ‹æ—¥æœŸ: 20250430 - 20250505
å‚è€ƒå†å²: å‰3å¹´
è‡ªå®šä¹‰é…ç½®: å¦
============================================================

åŸºæœŸæ•°æ®æŸ¥è¯¢æˆåŠŸï¼š310è¡Œ
åŸºæœŸæ—¥å‡è®¡ç®—å®Œæˆï¼Œå…±10æ¡çº¿è·¯æ•°æ®
base_avg ç±»å‹: <class 'pandas.core.frame.DataFrame'>, å½¢çŠ¶: (10, 3), åˆ—: ['F_LINENO', 'F_LINENAME', 'åŸºæœŸæ—¥å‡']
base_avg å‰å‡ è¡Œ:
   F_LINENO F_LINENAME          åŸºæœŸæ—¥å‡
0         0         çº¿ç½‘  2.228510e+06
1         1        1å·çº¿  3.966289e+05
2         2        2å·çº¿  5.098189e+05
3         3        3å·çº¿  3.250200e+05
4         4        4å·çº¿  3.579985e+05

===== å¤„ç†ç¬¬1å¹´å†å²æ•°æ®ï¼š2024å¹´ =====
âœ“ 2024å¹´ï¼šå‚è€ƒæœŸ60è¡Œ

===== å¤„ç†ç¬¬2å¹´å†å²æ•°æ®ï¼š2023å¹´ =====
âœ“ 2023å¹´ï¼šå‚è€ƒæœŸ54è¡Œ

===== å¤„ç†ç¬¬3å¹´å†å²æ•°æ®ï¼š2022å¹´ =====
âœ“ 2022å¹´ï¼šå‚è€ƒæœŸ54è¡Œ
âœ“ åˆå¹¶å®Œæˆï¼šå…±168è¡Œ

===== å¼€å§‹è®¡ç®—é¢„æµ‹ =====
æ ‡è®°å®Œæˆï¼Œå¼€å§‹è®¡ç®—æ¯å¤©çš„æœ€ä¼˜å¢é•¿ç‡...

âœ“ é¢„æµ‹è®¡ç®—å®Œæˆï¼šå…±60æ¡é¢„æµ‹è®°å½•

===== æŸ¥è¯¢å®é™…æ•°æ® =====
æ—¥æœŸèŒƒå›´ï¼š20250430 - 20250505
æŸ¥è¯¢ç»“æœï¼š60è¡Œ
å®é™…æ•°æ®çš„çº¿è·¯ï¼š[ 0  1  2  3  4  5  6 31 60 83]
å®é™…æ•°æ®çš„æ—¥æœŸï¼š['20250430', '20250501', '20250502', '20250503', '20250504', '20250505']

é¢„æµ‹æ•°æ®ç¤ºä¾‹ï¼ˆå‰3æ¡ï¼‰ï¼š
  é¢„æµ‹ 1: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250430 (<class 'str'>)
  é¢„æµ‹ 2: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250501 (<class 'str'>)
  é¢„æµ‹ 3: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250502 (<class 'str'>)

å®é™…æ•°æ®ç¤ºä¾‹ï¼ˆå‰3æ¡ï¼‰ï¼š
  å®é™… 1: çº¿è·¯=0 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)
  å®é™… 2: çº¿è·¯=1 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)
  å®é™… 3: çº¿è·¯=2 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)

å¼€å§‹åŒ¹é…é¢„æµ‹å€¼å’Œå®é™…å€¼...
  åŒ¹é… 1: çº¿è·¯0 æ—¥æœŸ20250430 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250430: é¢„æµ‹=3380872, å®é™…=2947596, å‡†ç¡®ç‡=85.3%
  åŒ¹é… 2: çº¿è·¯0 æ—¥æœŸ20250501 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250501: é¢„æµ‹=3212174, å®é™…=3128839, å‡†ç¡®ç‡=97.34%
  åŒ¹é… 3: çº¿è·¯0 æ—¥æœŸ20250502 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250502: é¢„æµ‹=2894166, å®é™…=3155998, å‡†ç¡®ç‡=91.7%

âœ“ åŒ¹é…å®Œæˆï¼š60/60 æ¡è®°å½•æœ‰å®é™…æ•°æ®
âœ“ æœ‰å‡†ç¡®ç‡çš„è®°å½•ï¼š60/60

============================================================
å‡†å¤‡è¿”å›ç»“æœï¼šhas_actual = True
predictions æ€»æ•° = 60
ç¬¬ä¸€æ¡è®°å½•ç¤ºä¾‹ï¼š{'çº¿è·¯ç¼–å·': 0, 'çº¿è·¯åç§°': 'çº¿ç½‘', 'é¢„æµ‹æ—¥æœŸ': '20250430', 'ç¬¬å‡ å¤©': 1, 'åŸºæœŸæ—¥å‡': 2228510, 'æœ€ä¼˜å¢é•¿ç‡': 51.71, 'æœ€ä¼˜æ¥æºå¹´ä»½': 2023, 'é¢„æµ‹å®¢æµ': 3380872, 'å®é™…å®¢æµ': 2947596, 'å‡†ç¡®ç‡': 85.3, 'è¯¯å·®': 433276}
============================================================


============================================================
é¢„æµ‹å®Œæˆï¼è¿”å›60æ¡è®°å½•
============================================================


============================================================
å¼€å§‹é¢„æµ‹çº¿è·¯å®¢æµ
æŒ‡æ ‡ç±»å‹: F_PKLCOUNT (å®¢æµé‡)
é¢„æµ‹æ—¥æœŸ: 20250430 - 20250505
å‚è€ƒå†å²: å‰4å¹´
è‡ªå®šä¹‰é…ç½®: å¦
============================================================

åŸºæœŸæ•°æ®æŸ¥è¯¢æˆåŠŸï¼š310è¡Œ
åŸºæœŸæ—¥å‡è®¡ç®—å®Œæˆï¼Œå…±10æ¡çº¿è·¯æ•°æ®
base_avg ç±»å‹: <class 'pandas.core.frame.DataFrame'>, å½¢çŠ¶: (10, 3), åˆ—: ['F_LINENO', 'F_LINENAME', 'åŸºæœŸæ—¥å‡']
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:20:04] "POST /predict_flow HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:22:51] "POST /predict_flow HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:30:55] "POST /check_station_data_availability HTTP/1.1" 200 -
base_avg å‰å‡ è¡Œ:
   F_LINENO F_LINENAME          åŸºæœŸæ—¥å‡
0         0         çº¿ç½‘  2.228510e+06
1         1        1å·çº¿  3.966289e+05
2         2        2å·çº¿  5.098189e+05
3         3        3å·çº¿  3.250200e+05
4         4        4å·çº¿  3.579985e+05

===== å¤„ç†ç¬¬1å¹´å†å²æ•°æ®ï¼š2024å¹´ =====
âœ“ 2024å¹´ï¼šå‚è€ƒæœŸ60è¡Œ

===== å¤„ç†ç¬¬2å¹´å†å²æ•°æ®ï¼š2023å¹´ =====
âœ“ 2023å¹´ï¼šå‚è€ƒæœŸ54è¡Œ

===== å¤„ç†ç¬¬3å¹´å†å²æ•°æ®ï¼š2022å¹´ =====
âœ“ 2022å¹´ï¼šå‚è€ƒæœŸ54è¡Œ

===== å¤„ç†ç¬¬4å¹´å†å²æ•°æ®ï¼š2021å¹´ =====
âš ï¸ 2021å¹´å‚è€ƒæœŸæ•°æ®ä¸ºç©ºï¼Œè·³è¿‡
âœ“ åˆå¹¶å®Œæˆï¼šå…±168è¡Œ

===== å¼€å§‹è®¡ç®—é¢„æµ‹ =====
æ ‡è®°å®Œæˆï¼Œå¼€å§‹è®¡ç®—æ¯å¤©çš„æœ€ä¼˜å¢é•¿ç‡...

âœ“ é¢„æµ‹è®¡ç®—å®Œæˆï¼šå…±60æ¡é¢„æµ‹è®°å½•

===== æŸ¥è¯¢å®é™…æ•°æ® =====
æ—¥æœŸèŒƒå›´ï¼š20250430 - 20250505
æŸ¥è¯¢ç»“æœï¼š60è¡Œ
å®é™…æ•°æ®çš„çº¿è·¯ï¼š[ 0  1  2  3  4  5  6 31 60 83]
å®é™…æ•°æ®çš„æ—¥æœŸï¼š['20250430', '20250501', '20250502', '20250503', '20250504', '20250505']

é¢„æµ‹æ•°æ®ç¤ºä¾‹ï¼ˆå‰3æ¡ï¼‰ï¼š
  é¢„æµ‹ 1: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250430 (<class 'str'>)
  é¢„æµ‹ 2: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250501 (<class 'str'>)
  é¢„æµ‹ 3: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250502 (<class 'str'>)

å®é™…æ•°æ®ç¤ºä¾‹ï¼ˆå‰3æ¡ï¼‰ï¼š
  å®é™… 1: çº¿è·¯=0 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)
  å®é™… 2: çº¿è·¯=1 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)
  å®é™… 3: çº¿è·¯=2 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)

å¼€å§‹åŒ¹é…é¢„æµ‹å€¼å’Œå®é™…å€¼...
  åŒ¹é… 1: çº¿è·¯0 æ—¥æœŸ20250430 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250430: é¢„æµ‹=3380872, å®é™…=2947596, å‡†ç¡®ç‡=85.3%
  åŒ¹é… 2: çº¿è·¯0 æ—¥æœŸ20250501 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250501: é¢„æµ‹=3212174, å®é™…=3128839, å‡†ç¡®ç‡=97.34%
  åŒ¹é… 3: çº¿è·¯0 æ—¥æœŸ20250502 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250502: é¢„æµ‹=2894166, å®é™…=3155998, å‡†ç¡®ç‡=91.7%

âœ“ åŒ¹é…å®Œæˆï¼š60/60 æ¡è®°å½•æœ‰å®é™…æ•°æ®
âœ“ æœ‰å‡†ç¡®ç‡çš„è®°å½•ï¼š60/60

============================================================
å‡†å¤‡è¿”å›ç»“æœï¼šhas_actual = True
predictions æ€»æ•° = 60
ç¬¬ä¸€æ¡è®°å½•ç¤ºä¾‹ï¼š{'çº¿è·¯ç¼–å·': 0, 'çº¿è·¯åç§°': 'çº¿ç½‘', 'é¢„æµ‹æ—¥æœŸ': '20250430', 'ç¬¬å‡ å¤©': 1, 'åŸºæœŸæ—¥å‡': 2228510, 'æœ€ä¼˜å¢é•¿ç‡': 51.71, 'æœ€ä¼˜æ¥æºå¹´ä»½': 2023, 'é¢„æµ‹å®¢æµ': 3380872, 'å®é™…å®¢æµ': 2947596, 'å‡†ç¡®ç‡': 85.3, 'è¯¯å·®': 433276}
============================================================


============================================================
é¢„æµ‹å®Œæˆï¼è¿”å›60æ¡è®°å½•
============================================================


============================================================
å¼€å§‹é¢„æµ‹çº¿è·¯å®¢æµ
æŒ‡æ ‡ç±»å‹: F_PKLCOUNT (å®¢æµé‡)
é¢„æµ‹æ—¥æœŸ: 20250430 - 20250505
å‚è€ƒå†å²: å‰4å¹´
è‡ªå®šä¹‰é…ç½®: å¦
============================================================

åŸºæœŸæ•°æ®æŸ¥è¯¢æˆåŠŸï¼š310è¡Œ
åŸºæœŸæ—¥å‡è®¡ç®—å®Œæˆï¼Œå…±10æ¡çº¿è·¯æ•°æ®
base_avg ç±»å‹: <class 'pandas.core.frame.DataFrame'>, å½¢çŠ¶: (10, 3), åˆ—: ['F_LINENO', 'F_LINENAME', 'åŸºæœŸæ—¥å‡']
base_avg å‰å‡ è¡Œ:
   F_LINENO F_LINENAME          åŸºæœŸæ—¥å‡
0         0         çº¿ç½‘  2.228510e+06
1         1        1å·çº¿  3.966289e+05
2         2        2å·çº¿  5.098189e+05
3         3        3å·çº¿  3.250200e+05
4         4        4å·çº¿  3.579985e+05

===== å¤„ç†ç¬¬1å¹´å†å²æ•°æ®ï¼š2024å¹´ =====
âœ“ 2024å¹´ï¼šå‚è€ƒæœŸ60è¡Œ

===== å¤„ç†ç¬¬2å¹´å†å²æ•°æ®ï¼š2023å¹´ =====
âœ“ 2023å¹´ï¼šå‚è€ƒæœŸ54è¡Œ

===== å¤„ç†ç¬¬3å¹´å†å²æ•°æ®ï¼š2022å¹´ =====
âœ“ 2022å¹´ï¼šå‚è€ƒæœŸ54è¡Œ

===== å¤„ç†ç¬¬4å¹´å†å²æ•°æ®ï¼š2021å¹´ =====
âš ï¸ 2021å¹´å‚è€ƒæœŸæ•°æ®ä¸ºç©ºï¼Œè·³è¿‡
âœ“ åˆå¹¶å®Œæˆï¼šå…±168è¡Œ

===== å¼€å§‹è®¡ç®—é¢„æµ‹ =====
æ ‡è®°å®Œæˆï¼Œå¼€å§‹è®¡ç®—æ¯å¤©çš„æœ€ä¼˜å¢é•¿ç‡...

âœ“ é¢„æµ‹è®¡ç®—å®Œæˆï¼šå…±60æ¡é¢„æµ‹è®°å½•

===== æŸ¥è¯¢å®é™…æ•°æ® =====
æ—¥æœŸèŒƒå›´ï¼š20250430 - 20250505
æŸ¥è¯¢ç»“æœï¼š60è¡Œ
å®é™…æ•°æ®çš„çº¿è·¯ï¼š[ 0  1  2  3  4  5  6 31 60 83]
å®é™…æ•°æ®çš„æ—¥æœŸï¼š['20250430', '20250501', '20250502', '20250503', '20250504', '20250505']

é¢„æµ‹æ•°æ®ç¤ºä¾‹ï¼ˆå‰3æ¡ï¼‰ï¼š
  é¢„æµ‹ 1: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250430 (<class 'str'>)
  é¢„æµ‹ 2: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250501 (<class 'str'>)
  é¢„æµ‹ 3: çº¿è·¯=0 (<class 'int'>), æ—¥æœŸ=20250502 (<class 'str'>)

å®é™…æ•°æ®ç¤ºä¾‹ï¼ˆå‰3æ¡ï¼‰ï¼š
  å®é™… 1: çº¿è·¯=0 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)
  å®é™… 2: çº¿è·¯=1 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)
  å®é™… 3: çº¿è·¯=2 (<class 'numpy.int64'>), æ—¥æœŸ=20250430 (<class 'str'>)

å¼€å§‹åŒ¹é…é¢„æµ‹å€¼å’Œå®é™…å€¼...
  åŒ¹é… 1: çº¿è·¯0 æ—¥æœŸ20250430 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250430: é¢„æµ‹=3380872, å®é™…=2947596, å‡†ç¡®ç‡=85.3%
  åŒ¹é… 2: çº¿è·¯0 æ—¥æœŸ20250501 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250501: é¢„æµ‹=3212174, å®é™…=3128839, å‡†ç¡®ç‡=97.34%
  åŒ¹é… 3: çº¿è·¯0 æ—¥æœŸ20250502 -> æ‰¾åˆ°1è¡Œ
  åŒ¹é…æˆåŠŸ - çº¿è·¯0 20250502: é¢„æµ‹=2894166, å®é™…=3155998, å‡†ç¡®ç‡=91.7%

âœ“ åŒ¹é…å®Œæˆï¼š60/60 æ¡è®°å½•æœ‰å®é™…æ•°æ®
âœ“ æœ‰å‡†ç¡®ç‡çš„è®°å½•ï¼š60/60

============================================================
å‡†å¤‡è¿”å›ç»“æœï¼šhas_actual = True
predictions æ€»æ•° = 60
ç¬¬ä¸€æ¡è®°å½•ç¤ºä¾‹ï¼š{'çº¿è·¯ç¼–å·': 0, 'çº¿è·¯åç§°': 'çº¿ç½‘', 'é¢„æµ‹æ—¥æœŸ': '20250430', 'ç¬¬å‡ å¤©': 1, 'åŸºæœŸæ—¥å‡': 2228510, 'æœ€ä¼˜å¢é•¿ç‡': 51.71, 'æœ€ä¼˜æ¥æºå¹´ä»½': 2023, 'é¢„æµ‹å®¢æµ': 3380872, 'å®é™…å®¢æµ': 2947596, 'å‡†ç¡®ç‡': 85.3, 'è¯¯å·®': 433276}
============================================================


============================================================
é¢„æµ‹å®Œæˆï¼è¿”å›60æ¡è®°å½•
============================================================

åº”ç”¨è½¦ç«™è¿‡æ»¤ï¼š['æ©˜å­æ´²', 'äº”ä¸€å¹¿åœº', 'ç¢§æ²™æ¹–']
å®Œæ•´SQL:

        SELECT 
            S.ID,
            REPLACE(S.SQUAD_DATE, '-', '') AS F_DATE,
            S.STATION_ID AS F_LINENO,
            S.STATION_NAME AS F_LINENAME,
            S.PASSENGER_NUM AS F_KLCOUNT,
            C.F_DATEFEATURES,
            C.F_ISHOLIDAY,
            C.F_ISNONGLI,
            C.F_ISYANGLI,
            C.F_NEXTDAY,
            C.F_HOLIDAYTHDAY,
            C.IS_FIRST,
            CC.F_YEAR,
            CC.F_DAYOFWEEK,
            CC.F_WEEK,
            CC.F_HOLIDAYTYPE,
            CC.F_HOLIDAYDAYS,
            CC.F_HOLIDAYWHICHDAY,
            CC.COVID19,
            CC.F_WEATHER,
            W.F_TQQK AS WEATHER_TYPE
        FROM 
            [StationFlowPredict].[dbo].[STATION_FLOW_HISTORY] AS S
        LEFT JOIN 
            master.dbo.LSTM_COMMON_HOLIDAYFEATURE AS C
            ON REPLACE(S.SQUAD_DATE, '-', '') = C.F_DATE
        LEFT JOIN 
            master.dbo.CalendarHistory AS CC
            ON REPLACE(S.SQUAD_DATE, '-', '') = CC.F_DATE
        LEFT JOIN
            master.dbo.WeatherHistory AS W
            ON REPLACE(S.SQUAD_DATE, '-', '') = W.F_DATE
        WHERE 
            REPLACE(S.SQUAD_DATE, '-', '') >= '20250501'
            AND REPLACE(S.SQUAD_DATE, '-', '') <= '20250505'
            AND S.STATION_NAME IN (N'æ©˜å­æ´²', N'äº”ä¸€å¹¿åœº', N'ç¢§æ²™æ¹–')
        ORDER BY 
            REPLACE(S.SQUAD_DATE, '-', ''), S.STATION_ID
        
è½¦ç«™æ•°æ®æŸ¥è¯¢å®Œæˆï¼š20è¡Œ
å¼€å§‹åˆå¹¶è½¦ç«™æ•°æ®ï¼ŒåŸå§‹20è¡Œ...
âœ“ åˆå¹¶å®Œæˆï¼š15è¡Œ
åº”ç”¨è½¦ç«™è¿‡æ»¤ï¼š['æ©˜å­æ´²', 'äº”ä¸€å¹¿åœº', 'ç¢§æ²™æ¹–']
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:31:02] "POST /check_station_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:31:06] "POST /check_station_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:31:09] "POST /check_station_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
å®Œæ•´SQL:

        SELECT 
            S.ID,
            REPLACE(S.SQUAD_DATE, '-', '') AS F_DATE,
            S.STATION_ID AS F_LINENO,
            S.STATION_NAME AS F_LINENAME,
            S.PASSENGER_NUM AS F_KLCOUNT,
            C.F_DATEFEATURES,
            C.F_ISHOLIDAY,
            C.F_ISNONGLI,
            C.F_ISYANGLI,
            C.F_NEXTDAY,
            C.F_HOLIDAYTHDAY,
            C.IS_FIRST,
            CC.F_YEAR,
            CC.F_DAYOFWEEK,
            CC.F_WEEK,
            CC.F_HOLIDAYTYPE,
            CC.F_HOLIDAYDAYS,
            CC.F_HOLIDAYWHICHDAY,
            CC.COVID19,
            CC.F_WEATHER,
            W.F_TQQK AS WEATHER_TYPE
        FROM 
            [StationFlowPredict].[dbo].[STATION_FLOW_HISTORY] AS S
        LEFT JOIN 
            master.dbo.LSTM_COMMON_HOLIDAYFEATURE AS C
            ON REPLACE(S.SQUAD_DATE, '-', '') = C.F_DATE
        LEFT JOIN 
            master.dbo.CalendarHistory AS CC
            ON REPLACE(S.SQUAD_DATE, '-', '') = CC.F_DATE
        LEFT JOIN
            master.dbo.WeatherHistory AS W
            ON REPLACE(S.SQUAD_DATE, '-', '') = W.F_DATE
        WHERE 
            REPLACE(S.SQUAD_DATE, '-', '') >= '20250430'
            AND REPLACE(S.SQUAD_DATE, '-', '') <= '20250504'
            AND S.STATION_NAME IN (N'æ©˜å­æ´²', N'äº”ä¸€å¹¿åœº', N'ç¢§æ²™æ¹–')
        ORDER BY 
            REPLACE(S.SQUAD_DATE, '-', ''), S.STATION_ID
        
è½¦ç«™æ•°æ®æŸ¥è¯¢å®Œæˆï¼š20è¡Œ
å¼€å§‹åˆå¹¶è½¦ç«™æ•°æ®ï¼ŒåŸå§‹20è¡Œ...
âœ“ åˆå¹¶å®Œæˆï¼š15è¡Œ
åº”ç”¨è½¦ç«™è¿‡æ»¤ï¼š['æ©˜å­æ´²', 'äº”ä¸€å¹¿åœº', 'ç¢§æ²™æ¹–']
å®Œæ•´SQL:

        SELECT 
            S.ID,
            REPLACE(S.SQUAD_DATE, '-', '') AS F_DATE,
            S.STATION_ID AS F_LINENO,
            S.STATION_NAME AS F_LINENAME,
            S.PASSENGER_NUM AS F_KLCOUNT,
            C.F_DATEFEATURES,
            C.F_ISHOLIDAY,
            C.F_ISNONGLI,
            C.F_ISYANGLI,
            C.F_NEXTDAY,
            C.F_HOLIDAYTHDAY,
            C.IS_FIRST,
            CC.F_YEAR,
            CC.F_DAYOFWEEK,
            CC.F_WEEK,
            CC.F_HOLIDAYTYPE,
            CC.F_HOLIDAYDAYS,
            CC.F_HOLIDAYWHICHDAY,
            CC.COVID19,
            CC.F_WEATHER,
            W.F_TQQK AS WEATHER_TYPE
        FROM 
            [StationFlowPredict].[dbo].[STATION_FLOW_HISTORY] AS S
        LEFT JOIN 
            master.dbo.LSTM_COMMON_HOLIDAYFEATURE AS C
            ON REPLACE(S.SQUAD_DATE, '-', '') = C.F_DATE
        LEFT JOIN 
            master.dbo.CalendarHistory AS CC
            ON REPLACE(S.SQUAD_DATE, '-', '') = CC.F_DATE
        LEFT JOIN
            master.dbo.WeatherHistory AS W
            ON REPLACE(S.SQUAD_DATE, '-', '') = W.F_DATE
        WHERE 
            REPLACE(S.SQUAD_DATE, '-', '') >= '20250430'
            AND REPLACE(S.SQUAD_DATE, '-', '') <= '20250505'
            AND S.STATION_NAME IN (N'æ©˜å­æ´²', N'äº”ä¸€å¹¿åœº', N'ç¢§æ²™æ¹–')
        ORDER BY 
            REPLACE(S.SQUAD_DATE, '-', ''), S.STATION_ID
        
è½¦ç«™æ•°æ®æŸ¥è¯¢å®Œæˆï¼š24è¡Œ
å¼€å§‹åˆå¹¶è½¦ç«™æ•°æ®ï¼ŒåŸå§‹24è¡Œ...
âœ“ åˆå¹¶å®Œæˆï¼š18è¡Œ
åº”ç”¨è½¦ç«™è¿‡æ»¤ï¼š['æ©˜å­æ´²', 'äº”ä¸€å¹¿åœº', 'ç¢§æ²™æ¹–']
å®Œæ•´SQL:

        SELECT 
            S.ID,
            REPLACE(S.SQUAD_DATE, '-', '') AS F_DATE,
            S.STATION_ID AS F_LINENO,
            S.STATION_NAME AS F_LINENAME,
            S.PASSENGER_NUM AS F_KLCOUNT,
            C.F_DATEFEATURES,
            C.F_ISHOLIDAY,
            C.F_ISNONGLI,
            C.F_ISYANGLI,
            C.F_NEXTDAY,
            C.F_HOLIDAYTHDAY,
            C.IS_FIRST,
            CC.F_YEAR,
            CC.F_DAYOFWEEK,
            CC.F_WEEK,
            CC.F_HOLIDAYTYPE,
            CC.F_HOLIDAYDAYS,
            CC.F_HOLIDAYWHICHDAY,
            CC.COVID19,
            CC.F_WEATHER,
            W.F_TQQK AS WEATHER_TYPE
        FROM 
            [StationFlowPredict].[dbo].[STATION_FLOW_HISTORY] AS S
        LEFT JOIN 
            master.dbo.LSTM_COMMON_HOLIDAYFEATURE AS C
            ON REPLACE(S.SQUAD_DATE, '-', '') = C.F_DATE
        LEFT JOIN 
            master.dbo.CalendarHistory AS CC
            ON REPLACE(S.SQUAD_DATE, '-', '') = CC.F_DATE
        LEFT JOIN
            master.dbo.WeatherHistory AS W
            ON REPLACE(S.SQUAD_DATE, '-', '') = W.F_DATE
        WHERE 
            REPLACE(S.SQUAD_DATE, '-', '') >= '20250430'
            AND REPLACE(S.SQUAD_DATE, '-', '') <= '20250505'
            AND S.STATION_NAME IN (N'æ©˜å­æ´²', N'äº”ä¸€å¹¿åœº', N'ç¢§æ²™æ¹–')
        ORDER BY 
            REPLACE(S.SQUAD_DATE, '-', ''), S.STATION_ID
        
è½¦ç«™æ•°æ®æŸ¥è¯¢å®Œæˆï¼š24è¡Œ
å¼€å§‹åˆå¹¶è½¦ç«™æ•°æ®ï¼ŒåŸå§‹24è¡Œ...
âœ“ åˆå¹¶å®Œæˆï¼š18è¡Œ

============================================================
å¼€å§‹é¢„æµ‹è½¦ç«™å®¢æµ
============================================================

åº”ç”¨è½¦ç«™è¿‡æ»¤ï¼š['æ©˜å­æ´²', 'äº”ä¸€å¹¿åœº', 'ç¢§æ²™æ¹–']
å®Œæ•´SQL:

        SELECT 
            S.ID,
            REPLACE(S.SQUAD_DATE, '-', '') AS F_DATE,
            S.STATION_ID AS F_LINENO,
            S.STATION_NAME AS F_LINENAME,
            S.PASSENGER_NUM AS F_KLCOUNT,
            C.F_DATEFEATURES,
            C.F_ISHOLIDAY,
            C.F_ISNONGLI,
            C.F_ISYANGLI,
            C.F_NEXTDAY,
            C.F_HOLIDAYTHDAY,
            C.IS_FIRST,
            CC.F_YEAR,
            CC.F_DAYOFWEEK,
            CC.F_WEEK,
            CC.F_HOLIDAYTYPE,
            CC.F_HOLIDAYDAYS,
            CC.F_HOLIDAYWHICHDAY,
            CC.COVID19,
            CC.F_WEATHER,
            W.F_TQQK AS WEATHER_TYPE
        FROM 
            [StationFlowPredict].[dbo].[STATION_FLOW_HISTORY] AS S
        LEFT JOIN 
            master.dbo.LSTM_COMMON_HOLIDAYFEATURE AS C
            ON REPLACE(S.SQUAD_DATE, '-', '') = C.F_DATE
        LEFT JOIN 
            master.dbo.CalendarHistory AS CC
            ON REPLACE(S.SQUAD_DATE, '-', '') = CC.F_DATE
        LEFT JOIN
            master.dbo.WeatherHistory AS W
            ON REPLACE(S.SQUAD_DATE, '-', '') = W.F_DATE
        WHERE 
            REPLACE(S.SQUAD_DATE, '-', '') >= '20250301'
            AND REPLACE(S.SQUAD_DATE, '-', '') <= '20250331'
            AND S.STATION_NAME IN (N'æ©˜å­æ´²', N'äº”ä¸€å¹¿åœº', N'ç¢§æ²™æ¹–')
        ORDER BY 
            REPLACE(S.SQUAD_DATE, '-', ''), S.STATION_ID
        
è½¦ç«™æ•°æ®æŸ¥è¯¢å®Œæˆï¼š124è¡Œ
å¼€å§‹åˆå¹¶è½¦ç«™æ•°æ®ï¼ŒåŸå§‹124è¡Œ...
âœ“ åˆå¹¶å®Œæˆï¼š93è¡Œ
âœ“ åŸºæœŸï¼š3ä¸ªè½¦ç«™

ğŸ” å¼€å§‹æŸ¥è¯¢å†å¹´åŒæœŸæ•°æ®ï¼ˆå…±2å¹´ï¼‰...

ğŸ“… å¤„ç†ç¬¬1å¹´ï¼š2024å¹´
  ğŸ”¸ æŸ¥è¯¢å‚è€ƒæœŸï¼š20240430 - 20240505
åº”ç”¨è½¦ç«™è¿‡æ»¤ï¼š['æ©˜å­æ´²', 'äº”ä¸€å¹¿åœº', 'ç¢§æ²™æ¹–']
å®Œæ•´SQL:

        SELECT 
            S.ID,
            REPLACE(S.SQUAD_DATE, '-', '') AS F_DATE,
            S.STATION_ID AS F_LINENO,
            S.STATION_NAME AS F_LINENAME,
            S.PASSENGER_NUM AS F_KLCOUNT,
            C.F_DATEFEATURES,
            C.F_ISHOLIDAY,
            C.F_ISNONGLI,
            C.F_ISYANGLI,
            C.F_NEXTDAY,
            C.F_HOLIDAYTHDAY,
            C.IS_FIRST,
            CC.F_YEAR,
            CC.F_DAYOFWEEK,
            CC.F_WEEK,
            CC.F_HOLIDAYTYPE,
            CC.F_HOLIDAYDAYS,
            CC.F_HOLIDAYWHICHDAY,
            CC.COVID19,
            CC.F_WEATHER,
            W.F_TQQK AS WEATHER_TYPE
        FROM 
            [StationFlowPredict].[dbo].[STATION_FLOW_HISTORY] AS S
        LEFT JOIN 
            master.dbo.LSTM_COMMON_HOLIDAYFEATURE AS C
            ON REPLACE(S.SQUAD_DATE, '-', '') = C.F_DATE
        LEFT JOIN 
            master.dbo.CalendarHistory AS CC
            ON REPLACE(S.SQUAD_DATE, '-', '') = CC.F_DATE
        LEFT JOIN
            master.dbo.WeatherHistory AS W
            ON REPLACE(S.SQUAD_DATE, '-', '') = W.F_DATE
        WHERE 
            REPLACE(S.SQUAD_DATE, '-', '') >= '20240430'
            AND REPLACE(S.SQUAD_DATE, '-', '') <= '20240505'
            AND S.STATION_NAME IN (N'æ©˜å­æ´²', N'äº”ä¸€å¹¿åœº', N'ç¢§æ²™æ¹–')
        ORDER BY 
            REPLACE(S.SQUAD_DATE, '-', ''), S.STATION_ID
        
è½¦ç«™æ•°æ®æŸ¥è¯¢å®Œæˆï¼š24è¡Œ
å¼€å§‹åˆå¹¶è½¦ç«™æ•°æ®ï¼ŒåŸå§‹24è¡Œ...
âœ“ åˆå¹¶å®Œæˆï¼š18è¡Œ
  âœ“ å‚è€ƒæœŸï¼š18è¡Œï¼Œ3ä¸ªè½¦ç«™
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
  ğŸ”¸ æŸ¥è¯¢åŸºæœŸï¼š20240301 - 20240331
åº”ç”¨è½¦ç«™è¿‡æ»¤ï¼š['æ©˜å­æ´²', 'äº”ä¸€å¹¿åœº', 'ç¢§æ²™æ¹–']
å®Œæ•´SQL:

        SELECT 
            S.ID,
            REPLACE(S.SQUAD_DATE, '-', '') AS F_DATE,
            S.STATION_ID AS F_LINENO,
            S.STATION_NAME AS F_LINENAME,
            S.PASSENGER_NUM AS F_KLCOUNT,
            C.F_DATEFEATURES,
            C.F_ISHOLIDAY,
            C.F_ISNONGLI,
            C.F_ISYANGLI,
            C.F_NEXTDAY,
            C.F_HOLIDAYTHDAY,
            C.IS_FIRST,
            CC.F_YEAR,
            CC.F_DAYOFWEEK,
            CC.F_WEEK,
            CC.F_HOLIDAYTYPE,
            CC.F_HOLIDAYDAYS,
            CC.F_HOLIDAYWHICHDAY,
            CC.COVID19,
            CC.F_WEATHER,
            W.F_TQQK AS WEATHER_TYPE
        FROM 
            [StationFlowPredict].[dbo].[STATION_FLOW_HISTORY] AS S
        LEFT JOIN 
            master.dbo.LSTM_COMMON_HOLIDAYFEATURE AS C
            ON REPLACE(S.SQUAD_DATE, '-', '') = C.F_DATE
        LEFT JOIN 
            master.dbo.CalendarHistory AS CC
            ON REPLACE(S.SQUAD_DATE, '-', '') = CC.F_DATE
        LEFT JOIN
            master.dbo.WeatherHistory AS W
            ON REPLACE(S.SQUAD_DATE, '-', '') = W.F_DATE
        WHERE 
            REPLACE(S.SQUAD_DATE, '-', '') >= '20240301'
            AND REPLACE(S.SQUAD_DATE, '-', '') <= '20240331'
            AND S.STATION_NAME IN (N'æ©˜å­æ´²', N'äº”ä¸€å¹¿åœº', N'ç¢§æ²™æ¹–')
        ORDER BY 
            REPLACE(S.SQUAD_DATE, '-', ''), S.STATION_ID
        
è½¦ç«™æ•°æ®æŸ¥è¯¢å®Œæˆï¼š124è¡Œ
å¼€å§‹åˆå¹¶è½¦ç«™æ•°æ®ï¼ŒåŸå§‹124è¡Œ...
âœ“ åˆå¹¶å®Œæˆï¼š93è¡Œ
  âœ“ åŸºæœŸï¼š93è¡Œï¼Œ3ä¸ªè½¦ç«™
  ğŸ”¸ è®¡ç®—2024å¹´åŸºæœŸæ—¥å‡...
  âœ“ åŸºæœŸæ—¥å‡ï¼š3ä¸ªè½¦ç«™
  ğŸ”¸ åˆå¹¶æ•°æ®å¹¶è®¡ç®—å¢é•¿ç‡...
  âœ“ åˆå¹¶ï¼š18è¡Œ -> 18è¡Œ
  âœ“ å¢é•¿ç‡ï¼šå¹³å‡61.41%ï¼Œæœ€å¤§161.25%
  âœ“ ç»Ÿè®¡å®Œæˆï¼š3ä¸ªè½¦ç«™

ğŸ“… å¤„ç†ç¬¬2å¹´ï¼š2023å¹´
  ğŸ”¸ æŸ¥è¯¢å‚è€ƒæœŸï¼š20230430 - 20230505
åº”ç”¨è½¦ç«™è¿‡æ»¤ï¼š['æ©˜å­æ´²', 'äº”ä¸€å¹¿åœº', 'ç¢§æ²™æ¹–']
å®Œæ•´SQL:

        SELECT 
            S.ID,
            REPLACE(S.SQUAD_DATE, '-', '') AS F_DATE,
            S.STATION_ID AS F_LINENO,
            S.STATION_NAME AS F_LINENAME,
            S.PASSENGER_NUM AS F_KLCOUNT,
            C.F_DATEFEATURES,
            C.F_ISHOLIDAY,
            C.F_ISNONGLI,
            C.F_ISYANGLI,
            C.F_NEXTDAY,
            C.F_HOLIDAYTHDAY,
            C.IS_FIRST,
            CC.F_YEAR,
            CC.F_DAYOFWEEK,
            CC.F_WEEK,
            CC.F_HOLIDAYTYPE,
            CC.F_HOLIDAYDAYS,
            CC.F_HOLIDAYWHICHDAY,
            CC.COVID19,
            CC.F_WEATHER,
            W.F_TQQK AS WEATHER_TYPE
        FROM 
            [StationFlowPredict].[dbo].[STATION_FLOW_HISTORY] AS S
        LEFT JOIN 
            master.dbo.LSTM_COMMON_HOLIDAYFEATURE AS C
            ON REPLACE(S.SQUAD_DATE, '-', '') = C.F_DATE
        LEFT JOIN 
            master.dbo.CalendarHistory AS CC
            ON REPLACE(S.SQUAD_DATE, '-', '') = CC.F_DATE
        LEFT JOIN
            master.dbo.WeatherHistory AS W
            ON REPLACE(S.SQUAD_DATE, '-', '') = W.F_DATE
        WHERE 
            REPLACE(S.SQUAD_DATE, '-', '') >= '20230430'
            AND REPLACE(S.SQUAD_DATE, '-', '') <= '20230505'
            AND S.STATION_NAME IN (N'æ©˜å­æ´²', N'äº”ä¸€å¹¿åœº', N'ç¢§æ²™æ¹–')
        ORDER BY 
            REPLACE(S.SQUAD_DATE, '-', ''), S.STATION_ID
        
è½¦ç«™æ•°æ®æŸ¥è¯¢å®Œæˆï¼š24è¡Œ
å¼€å§‹åˆå¹¶è½¦ç«™æ•°æ®ï¼ŒåŸå§‹24è¡Œ...
âœ“ åˆå¹¶å®Œæˆï¼š18è¡Œ
  âœ“ å‚è€ƒæœŸï¼š18è¡Œï¼Œ3ä¸ªè½¦ç«™
  ğŸ”¸ æŸ¥è¯¢åŸºæœŸï¼š20230301 - 20230331
åº”ç”¨è½¦ç«™è¿‡æ»¤ï¼š['æ©˜å­æ´²', 'äº”ä¸€å¹¿åœº', 'ç¢§æ²™æ¹–']
å®Œæ•´SQL:

        SELECT 
            S.ID,
            REPLACE(S.SQUAD_DATE, '-', '') AS F_DATE,
            S.STATION_ID AS F_LINENO,
            S.STATION_NAME AS F_LINENAME,
            S.PASSENGER_NUM AS F_KLCOUNT,
            C.F_DATEFEATURES,
            C.F_ISHOLIDAY,
            C.F_ISNONGLI,
            C.F_ISYANGLI,
            C.F_NEXTDAY,
            C.F_HOLIDAYTHDAY,
            C.IS_FIRST,
            CC.F_YEAR,
            CC.F_DAYOFWEEK,
            CC.F_WEEK,
            CC.F_HOLIDAYTYPE,
            CC.F_HOLIDAYDAYS,
            CC.F_HOLIDAYWHICHDAY,
            CC.COVID19,
            CC.F_WEATHER,
            W.F_TQQK AS WEATHER_TYPE
        FROM 
            [StationFlowPredict].[dbo].[STATION_FLOW_HISTORY] AS S
        LEFT JOIN 
            master.dbo.LSTM_COMMON_HOLIDAYFEATURE AS C
            ON REPLACE(S.SQUAD_DATE, '-', '') = C.F_DATE
        LEFT JOIN 
            master.dbo.CalendarHistory AS CC
            ON REPLACE(S.SQUAD_DATE, '-', '') = CC.F_DATE
        LEFT JOIN
            master.dbo.WeatherHistory AS W
            ON REPLACE(S.SQUAD_DATE, '-', '') = W.F_DATE
        WHERE 
            REPLACE(S.SQUAD_DATE, '-', '') >= '20230301'
            AND REPLACE(S.SQUAD_DATE, '-', '') <= '20230331'
            AND S.STATION_NAME IN (N'æ©˜å­æ´²', N'äº”ä¸€å¹¿åœº', N'ç¢§æ²™æ¹–')
        ORDER BY 
            REPLACE(S.SQUAD_DATE, '-', ''), S.STATION_ID
        
è½¦ç«™æ•°æ®æŸ¥è¯¢å®Œæˆï¼š124è¡Œ
å¼€å§‹åˆå¹¶è½¦ç«™æ•°æ®ï¼ŒåŸå§‹124è¡Œ...
âœ“ åˆå¹¶å®Œæˆï¼š93è¡Œ
  âœ“ åŸºæœŸï¼š93è¡Œï¼Œ3ä¸ªè½¦ç«™
  ğŸ”¸ è®¡ç®—2023å¹´åŸºæœŸæ—¥å‡...
  âœ“ åŸºæœŸæ—¥å‡ï¼š3ä¸ªè½¦ç«™
  ğŸ”¸ åˆå¹¶æ•°æ®å¹¶è®¡ç®—å¢é•¿ç‡...
  âœ“ åˆå¹¶ï¼š18è¡Œ -> 18è¡Œ
  âœ“ å¢é•¿ç‡ï¼šå¹³å‡56.06%ï¼Œæœ€å¤§195.59%
  âœ“ ç»Ÿè®¡å®Œæˆï¼š3ä¸ªè½¦ç«™

ğŸ”„ åˆå¹¶æ‰€æœ‰å†å¹´æ•°æ®...
âœ“ åˆå¹¶å®Œæˆï¼š36è¡Œ
ğŸ”¸ æ’åºå¹¶æ ‡è®°å¤©æ•°...
âœ“ æ ‡è®°å®Œæˆï¼š6å¤©

ğŸ”® å¼€å§‹é¢„æµ‹è®¡ç®—...
ğŸ“Š å¾…é¢„æµ‹è½¦ç«™æ•°ï¼š3ä¸ª
  ğŸ”¸ [1/3] æ©˜å­æ´²ï¼ˆID:05      ï¼ŒåŸºæœŸæ—¥å‡:28353ï¼‰
    âœ“ é¢„æµ‹6å¤©
  ğŸ”¸ [2/3] äº”ä¸€å¹¿åœºï¼ˆID:07      ï¼ŒåŸºæœŸæ—¥å‡:139636ï¼‰
    âœ“ é¢„æµ‹6å¤©
  ğŸ”¸ [3/3] ç¢§æ²™æ¹–ï¼ˆID:14      ï¼ŒåŸºæœŸæ—¥å‡:9583ï¼‰
    âœ“ é¢„æµ‹6å¤©

âœ… é¢„æµ‹å®Œæˆï¼šå…±18æ¡è®°å½•

ğŸ“Š æŸ¥è¯¢å®é™…æ•°æ®è¿›è¡Œå‡†ç¡®ç‡å¯¹æ¯”...
ğŸ”¸ æŸ¥è¯¢æ—¥æœŸèŒƒå›´ï¼š20250430 - 20250505
åº”ç”¨è½¦ç«™è¿‡æ»¤ï¼š['æ©˜å­æ´²', 'äº”ä¸€å¹¿åœº', 'ç¢§æ²™æ¹–']
å®Œæ•´SQL:

        SELECT 
            S.ID,
            REPLACE(S.SQUAD_DATE, '-', '') AS F_DATE,
            S.STATION_ID AS F_LINENO,
            S.STATION_NAME AS F_LINENAME,
            S.PASSENGER_NUM AS F_KLCOUNT,
            C.F_DATEFEATURES,
            C.F_ISHOLIDAY,
            C.F_ISNONGLI,
            C.F_ISYANGLI,
            C.F_NEXTDAY,
            C.F_HOLIDAYTHDAY,
            C.IS_FIRST,
            CC.F_YEAR,
            CC.F_DAYOFWEEK,
            CC.F_WEEK,
            CC.F_HOLIDAYTYPE,
            CC.F_HOLIDAYDAYS,
            CC.F_HOLIDAYWHICHDAY,
            CC.COVID19,
            CC.F_WEATHER,
            W.F_TQQK AS WEATHER_TYPE
        FROM 
            [StationFlowPredict].[dbo].[STATION_FLOW_HISTORY] AS S
        LEFT JOIN 
            master.dbo.LSTM_COMMON_HOLIDAYFEATURE AS C
            ON REPLACE(S.SQUAD_DATE, '-', '') = C.F_DATE
        LEFT JOIN 
            master.dbo.CalendarHistory AS CC
            ON REPLACE(S.SQUAD_DATE, '-', '') = CC.F_DATE
        LEFT JOIN
            master.dbo.WeatherHistory AS W
            ON REPLACE(S.SQUAD_DATE, '-', '') = W.F_DATE
        WHERE 
            REPLACE(S.SQUAD_DATE, '-', '') >= '20250430'
            AND REPLACE(S.SQUAD_DATE, '-', '') <= '20250505'
            AND S.STATION_NAME IN (N'æ©˜å­æ´²', N'äº”ä¸€å¹¿åœº', N'ç¢§æ²™æ¹–')
        ORDER BY 
            REPLACE(S.SQUAD_DATE, '-', ''), S.STATION_ID
        
è½¦ç«™æ•°æ®æŸ¥è¯¢å®Œæˆï¼š24è¡Œ
å¼€å§‹åˆå¹¶è½¦ç«™æ•°æ®ï¼ŒåŸå§‹24è¡Œ...
âœ“ åˆå¹¶å®Œæˆï¼š18è¡Œ
âœ“ æŸ¥åˆ°å®é™…æ•°æ®ï¼š18è¡Œï¼Œ3ä¸ªè½¦ç«™
ğŸ”¸ å¼€å§‹åŒ¹é…é¢„æµ‹æ•°æ®ä¸å®é™…æ•°æ®...
    âœ“ [æ©˜å­æ´²] 20250430: é¢„æµ‹78478 vs å®é™…38671ï¼Œå‡†ç¡®ç‡-2.94%
    âœ“ [æ©˜å­æ´²] 20250501: é¢„æµ‹83808 vs å®é™…79600ï¼Œå‡†ç¡®ç‡94.71%
    âœ“ [æ©˜å­æ´²] 20250502: é¢„æµ‹71752 vs å®é™…98266ï¼Œå‡†ç¡®ç‡73.02%
âœ… å‡†ç¡®ç‡å¯¹æ¯”å®Œæˆï¼š18/18æ¡åŒ¹é…æˆåŠŸ
ğŸ“ˆ å¹³å‡å‡†ç¡®ç‡ï¼š69.17%

============================================================
ğŸ‰ è½¦ç«™é¢„æµ‹å®Œæˆï¼
  ğŸ“Š é¢„æµ‹è®°å½•æ•°ï¼š18æ¡
  ğŸ¯ å‡†ç¡®ç‡å¯¹æ¯”ï¼šæœ‰
  ğŸ“… é¢„æµ‹æœŸï¼š2025-04-30 è‡³ 2025-05-05
  ğŸ“† åŸºæœŸï¼š2025-03-01 è‡³ 2025-03-3110.1.33.138 - - [24/Oct/2025 01:31:12] "POST /predict_station_flow HTTP/1.1" 200 -
10.1.33.138 - - [24/Oct/2025 01:54:51] "GET / HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:54:51] "POST /check_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:186: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:54:51] "POST /check_station_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:54:57] "POST /check_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:55:06] "POST /check_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:55:08] "POST /check_data_availability HTTP/1.1" 200 -
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
/STFS_V1/script/äººå·¥ç®—æ³•/yunying.py:325: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(query, conn)
10.1.33.138 - - [24/Oct/2025 01:55:10] "POST /predict_flow HTTP/1.1" 200 -
